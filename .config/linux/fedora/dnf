#!/bin/bash -
source ./utils

log_info "Updating and upgrading any already-installade library"
sudo dnf upgrade --refresh

log_title "Installing base development packages..."
# need to install them to avoid probmles with other installations
sudo dnf install -y \
  gcc \
  make \
  zlib-devel \
  bzip2 \
  bzip2-devel \
  readline-devel \
  sqlite-devel \
  openssl-devel \
  libffi-devel \
  xz-devel \
  tk-devel \
  gdbm-devel \
  ncurses-devel \
  libuuid-devel \
  libtirpc-devel \
  wget

log_info "Installing my chore libraries"
sudo dnf install -y \
    cmake \
    xclip \
    tmux \
    fzf \
    ripgrep \
    ksnip \
    mpv \
    yt-dlp \
    git-delta \
    bat \
    neovim \
    keepass \
    tldr \
    newsboat \
    zathura \
    zathura-pdf-mupdf \

sudo dnf install -y syncthing
systemctl --user enable syncthing.service

sudo dnf copr enable pennbauman/ports # to enable the lf installation
sudo dnf install -y lf

# For my suckless dwm configuration
## install X server: in some cases it is not installed and will prevent to
## diplay dwm on the window manager list at login
sudo dnf install -y xorg-x11-server-Xorg
# X libraries
sudo dnf install xset
sudo dnf install -y libX11-devel libXft-devel libXinerama-devel libXrandr-devel fontconfig-devel freetype-devel libXext-devel pam-devel xorg-x11-server-Xorg
sudo dnf install -y xsetroot
sudo dnf copr enable linuxredneck/xwallpaper
sudo dnf install -y xwallpaper
sudo dnf install -y dunst


DEFAULT_PDF_READER=$(xdg-mime query default application/pdf)
ZATHURA_PDF_READER='org.pwmt.zathura.desktop'
if [ "$DEFAULT_PDF_READER" != "$ZATHURA_PDF_READER" ]; then
    log_info "Set zathura as the default PDF reader"
    xdg-mime default org.pwmt.zathura.desktop application/pdf
fi
